# Chapter 01 : 引言

## 网络实例

### 网络分类

按地域规模，网络可以分为：

- 个域网 PAN（Personal Area Network）
	- 能在便携式消费电器与通信设备之间进行短距离通信的网络
	- 覆盖范围一般在 10 米半径以内，如蓝牙耳机等
- 局域网 LAN（Local Area Network）
	- 局部地区形成的区域网络，如企业网络
	- 分布地区范围有限，可大可小，大到一栋建筑，小到办公室内的组网
	- 电脑 WLAN 接入、打印机共享等等
- 城域网 MAN（Metropolitan Area Network）
	- 范围覆盖一个城市的网络
- 广域网 WAN（Wide Area Network）
	- 覆盖很大地理区域，乃至覆盖地区和国家
***
### 互联网的构成

??? question "Internet 与 internet"

	事实上，Internet 与 internet 之间是有区别的，internet（互连网）是一个通用名词，泛指“网络的网络”由多个不同类型计算机网络互连而成的网络，除了常见的 TCP/IP 协议之外，还可以使用其他协议；而 Internet（互联网）则是 internet 其中的一个实例，特指遵循 TCP/IP 标准、利用路由器将各种计算机网络互连起来而形成的、覆盖全球的、特定的互连网

互联网的层级结构如下图所示：

![](../../../assets/Pasted%20image%2020250917145744.png)

![](../../../assets/Pasted%20image%2020250917150116.png)

其主要有以下组成部分：

- **网络边缘**
	- 端系统：位于互联网边缘与互联网相连的计算机和其他设备
	- 端系统由各类主机（Host）构成：桌面计算机、移动计算机、服务器、其他智能终端设备
		- 客户端：便携机、智能手机、平板电脑、智能手环等各类智能终端
		- 服务器（服务器通常位于数据中心）
		- **主机的功能**：容纳（即运行）应用程序、产生信息并向接入网发送数据、从网络接收数据并提供给应用程序
- **网络核心**
	- 由互联网端系统的分组交换设备和通信链路构成的网状网络
	    - 分组交换（路由器、链路层交换机）
	    - 通信链路（光纤、铜缆、无线电、激光链路）
***
### 接入网

- 接入网目标：将主机连接到边缘路由器上
	- **边缘路由器**：端系统 Host 去往任何其他远程端系统的路径上的第一台路由器
	- 各种异构网络可以通过边缘路由器加入
- 终端系统连接到边缘路由器的技术：
	- 有线网络接入技术：光纤到户 FTTH、以太网、同轴电缆、双绞线的 DSL、古老的拨号上网
	- 无线网络接入技术：WiFi、4G/5G、卫星广域覆盖
	- 接入场景：住宅（家庭）接入网、机构（学校、公司）接入网、移动接入网络（WiFi、4G/5G）
***
#### 光纤到户 FTTH

- 光纤到户 FTTH（Fiber To The Home）
	- 我国及全球先进地区普遍采用的光纤通信的传输方法
	- 分为两类：有源光纤网络 AON 和无源光纤网络 PON
	- 优点：带宽大、线路稳定
- 无源光纤网络 PON（Passive Optical Network）
	- OLT：局端的光线路终端
	- ONU：光网络单元（如光猫 ONT）
	- 光猫 ONT 通过一个或多个无源分光器，连接到局端的光线路终端 OLT，如下图所示：
	
	![](../../../assets/Pasted%20image%2020250918112935.png)
***
#### 数字用户线 DSL

- 数字用户线 DSL：Digital Subscriber Line
- 使用电话线连接到数字用户线接入复用器（DSLAM）
    - 在DSL电话线上，语音和数据可以同时传输
    - 数据进入互联网，语音连接到电话网
- 上下行速率不对称
    - 下行速率：24-52 Mbps
    - 上行速率：3.5-16 Mbps

![](../../../assets/Pasted%20image%2020250918114430.png)
***
#### 同轴电缆

- 同轴电缆：Cable
	- 家庭利用传统**有线电视信号线**（同轴电缆）接入头端上网
	- 多个家庭共享有线电视的头端
	- 上下行速率**不对称**：下行传输速率高达40 Mbps~1.2 Gbps，上行传输速率30~100 Mbps
- 混合光纤同轴电缆HFC
	- 先用同轴电缆接入光纤节点，再用光纤连接到头端

![](../../../assets/Pasted%20image%2020250918162445.png)
***
#### 无线接入

无线接入网通过基站（“接入点”）将终端系统连接到路由器上，主要有两种方式：

- 无线局域网（WLAN）
	- 通常在建筑物内或周围（10 米）
	- 802.11b/g/n (WiFi)：11、54、450 Mbps 等传输速率
	- Wi-Fi 6 最高速率可达 9.6Gbps
	
	![](../../../assets/Pasted%20image%2020250918163312.png)
	
- 广域蜂窝接入网
	- 由移动蜂窝网络运营商提供（10 公里）
	- 2G/3G/4G/5G 等蜂窝网络
	- 0.1 ~ 1000 Mbps 速率
	
	![](../../../assets/Pasted%20image%2020250918163327.png)
***
#### 企业和家庭网络

- 实际的接入网
    - 往往采用有线、无线等多种技术的混合
    - 甚至 WiFi 和 4G 等多种无线技术的混合接入
- 有线以太网接入
    - 100Mbps、1Gbps、10Gbps 等接入速率
- 无线 WiFi 接入
    - 11、54、450Mbps 等

![](../../../assets/Pasted%20image%2020250918164243.png)
***
### 物理介质

- 传输单位：位（bit）
    - 在发射机/接收机之间的物理介质上传播的数据的最小单位
    - 用比特表示（bit）
- 物理媒体
    - 是指发射机和接收机之间的具体链路介质
    - 引导型介质：信号在固体介质中传播，例如铜、光纤、同轴电缆
    - 非引导型介质：信号自由传播，例如无线电（陆地无线电、卫星无线电信道）
- 存储常用字节（Byte），K/M/G 层级为 $2^{10}$ 进制
- 传输常用比特（Bit），K/M/G 层级为 $10^3$ 进制
***
#### 光纤

- 光纤
    - 玻璃纤维携带光脉冲，每个脉冲一位
- 高速运行
    - 高速点对点传输（10-100Gbps 以上）
- 低误码率
    - 中继器相距很远，对电磁噪声免疫
***
#### 双绞线和同轴电缆

- 双绞线（Twisted Pair）
	- 两根绝缘铜线互相缠绕为一对
	- 电话线为 1 对双绞线
	- 网线为 4 对双绞线，广泛用于计算机网络（以太网）双向传输
	    - 第 5 类：100Mbps ~ 1Gbps
	    - 第 6 类：10Gbps
- 同轴电缆
	- 两根同心铜导线，双向传输
	- 电缆上的多个频率通道
	- 带宽可达 100Mbps
***
#### 非引导性介质

- 无线电
	- 在电磁频谱中各类“波段”携带信号
	- 没有物理“电线”
	- 不依赖介质的广播
	- 半双工（发送方到接收方）
- 传播环境影响
	- 反射
	- 物体阻挡
	- 干扰/噪声

无线链路有如下类型：

- 无线局域网（WiFi）：速率 10-100 Mbps；覆盖距离约 10 米
- 广域（如 3/4/5G 蜂窝）：覆盖范围约 10 公里以内
- 蓝牙：短距离，有限速率
- 地面微波：点对点通信；速率 45 Mbps
- 卫星：分为同步卫星和地轨卫星
    - 同步卫星：距离 36000 公里，往返时延约 280 毫秒
    - 低轨卫星：靠近地面，但需绕地球高速运动，需要大量卫星覆盖地球
***
## 网络核心

- **目标**：将海量的端系统互联起来
- **结构**：由各类交换机（路由器）和链路，构成网状网络
- **功能**：路由和转发，路由器转发模型如下：
	
	![](../../../assets/Pasted%20image%2020250918225454.png)
	
	- 路由：全局操作，确定数据分组从源到目标所使用的路径；需要路由协议和路由算法，产生路由表
	- 转发：本地操作，路由器或交换机将接收到的数据分组转发出去（即移动到该设备的某个输出接口）；确定转发出去的接口/链路，根据从“入接口”收到分组头中的目的地址，查找本地路由表，确定“出接口”
***
### 分组交换

分组交换，也称包交换，主机将数据分成分组，发送到网络；网络将数据分组从一个路由器转发到下一个路由器，通过从源到目标的路径上的链路，**逐跳传输**抵达目的地，主要示意图如下：

![](../../../assets/Pasted%20image%2020250918230609.png)

其主要特点有：

- 将大报文拆分成多个小分组
- 通信双方以分组为单位、使用存储-转发机制，实现数据交互的通信方式
- 以分组作为数据传输单元
- 每个分组的首部都含有地址（目的地址和源地址）等控制信息
- 每个分组在互联网中独立地选择传输路径
- 支持灵活的统计多路复用
***
### 电路交换

电路交换有如下特点：

- 通常采用面向连接方式
- 先呼叫建立连接，实现端到端的资源预留
- 预留的资源包括：链路带宽资源、交换机的交换能力
- 电路交换连接建立后，物理通路被通信双方独占，资源专用，即使空闲也不与其他连接共享
- 由于建立连接并预留资源，因此传输性能好；但如果传输中发生设备故障，则传输被中断

多路复用指的是在每一路上实现具有和专用链路类似的性能，该路资源专用，即使空闲也不与其他连接共享。电路交换有两种多路复用：频分多路复用（FDM）和时分多路复用（TDM）

![](../../../assets/Pasted%20image%2020250918231559.png)

但是，多路复用有一个缺点，它无法应对互联网中广泛存在的“突发”（Burst）流量
***
### 报文交换

- 存储&转发
	- 路由器需要接收到完整的整个数据报文后，才能开始向下一跳发送
- 存储转发带来报文的传输延迟
	- 将 L 位数据报文，以 R bps 的速率，发送到链路中，需要 $\frac{L}{R}$ 秒

!!! note "三种交换方式的比较"

	- 电路交换需要建立连接并预留资源，难以实现灵活复用
	- 报文交换和分组交换较灵活，抗毁性高，在传送突发数据时可提高网络利用率
	- 由于分组长度小于报文长度，分组交换比报文交换的时延小，也具有更好的灵活性
	
	![](../../../assets/Pasted%20image%2020250921150143.png)
***
## 协议与分层结构

### 协议设计目的

网络协议（Network Protocol）指的是为进行网络中的数据交换而建立的规则、标准或约定，通信双方需要共同遵守，互相理解，其目的为保证网络交流可靠性和自适应性、资源分配、解决拥塞问题和安全问题，其三要素如下：

- 语法：规定传输数据的格式（如何讲）
- 语义：规定所要完成的功能（讲什么）
- 时序：规定各种操作的顺序（双方讲话的顺序）

网络通信双方要说的事情多种多样，导致网络协议异常复杂
***
### 协议分层结构

- 层次栈（Protocol Stack）：降低网络设计的复杂性，网络使用层次结构的协议栈。每一层都使用其下一层所提供的服务，并为上一层提供自己的服务。
- 对等实体（Peer）：不同机器上构成相应层次的实体成为对等实体。
- 接口（Interface）：在每一对相邻层次之间的是接口；接口定义了下层向上层提供哪些**服务原语**。
- 网络体系结构（Network infrastructure）：层和协议的集合为网络体系结构，一个特定的系统所使用的一组协议，即每层的协议，称为协议栈。

![](../../../assets/Pasted%20image%2020250921152447.png)

对于分层结构来说，发送端层层封装、接收端层层解封装，不同层对应协议数据单元（PDU，Protocol Data Unit）

!!! note "服务原语"

	服务一般分为两种类型：面向连接传输服务和无连接传输服务，理解上可以认为面向连接是实时交互需要响应的，无连接是指传输过程中不需要应答。服务由一组可用于用户进程以访问服务的原语（操作）形式指定，原语告诉服务执行某些操作或报告对等实体所采取的操作。
	
	以面向连接传输服务为例，其六个核心服务原语如下图：
	
	![](../../../assets/Pasted%20image%2020250921153542.png)
***
### 服务与协议的关系

- 协议是“水平”的，服务是“垂直”的
- 实体使用协议来实现其定义的服务
- 上层实体通过接口使用下层实体的服务

![](../../../assets/Pasted%20image%2020250921153745.png)
***
## 参考模型

### OSI 参考模型

OSI 参考模型（Open Systems Interconnection Reference Model）是 ISO 制定的网络通信参考模型，分为七层，从上到下以此为应用层（Application Layer）、表示层（Presentation Layer）、会话层（Session Layer）、传输层（Transport Layer）、网络层（Network Layer）、数据链路层（Data Link Layer）、物理层（Physical Layer）

!!! note "7 层 OSI 参考模型"

	=== "物理层"
	
		物理层定义了如何在信道上传输0、1：Bits on the wire，其包含：
		
		- 机械接口（Mechanical）：网线接口大小形状、线缆排列等
		- 电子信号（Electronic）：电压、电流等
		- 时序接口（Timing）：采样频率、波特率、比特率等
		- 介质（Medium）：各种线缆、无线频谱等
	
	=== "数据链路层"
	
		数据链路层主要为了实现相邻网络实体间的数据传输，特别是为实现可靠的传输提供可能。其主要包括以下功能：
		
		- 成帧：将从物理层获取的比特流拆分为离散的帧
		- 错误检测与纠正：由于网络传输中信号传播存在衰减和延迟，因为通信错误不可避免，通过算法可以实现错误的检测甚至自动纠错，从而为提供可靠数据通信提供可能
		- 物理地址/MAC 地址：48 位，通常以 12 个十六进制数字来表示，理论上是全球唯一的网络标识，MAC 地址烧录在网卡上，不便更改
		- 流量控制，避免“淹没”（overwhelming）:当快速的发送端遇上慢速的接收端，慢速的接收端来不及出来像洪水一样涌来的数据，导致接收端缓存溢出，因此叫做“淹没”。数据链路层需要根据需要调节发送方的发送速度，这叫做流量控制。
		- 共享信道上的访问控制（MAC）：在同一个信道上，多个机器同时传输信号。例如：在同一间教室上课，如果没有课堂纪律，可能有多人同时发言，那就是混乱的菜场，而不是教师。
	
	=== "网络层"
	
		网络层负责将数据包从源主机送达目的主机。其主要功能包括：
		
		- 路由（Routing）：在网络中选取从源端到目的端转发路径，常常会根据网络可达性动态选取最佳路径，也可以使用静态路由
		- 路由协议：路由器之间交互路由信息所遵循的协议规范，使得单个路由器能够获取网络的可达性等信息
		- 服务质量（QoS）控制：处理网络拥塞、负载均衡、准入控制、保障延迟
		- 异构网络互联：在异构编址和异构网络中路由寻址和转发
	
	=== "传输层"
	
		传输层将数据从源端口发送到目的端口（进程到进程），和网络层不同：
		
		- 网络层定位到一台主机（host），传输层的作用域具体到主机上的某一个进程
		- 网络层的控制主要面向运营商，传输层为终端用户提供端到端的数据传输控制
		
		传输层包含两类传输模式：
		
		- 可靠传输：可靠的端到端数据传输，适合于对通信质量有要求的应用场景，如文件传输等
		- 不可靠传输：更快捷、更轻量的端到端数据传输，适合于对通信质量要求不高，对通信响应速度要求高的应用场景，如语音对话、视频会议等
	
	=== "会话层"
	
		会话层利用传输层提供的服务，在应用程序之间建立和维持会话，并能使会话获得同步。
	
	=== "表示层"
	
		表示层关注所传递信息的语法和语义，管理数据的表示方法，传输的数据结构
	
	=== "应用层"
	
		应用层通过应用层协议，提供应用程序便捷的网络服务调用
***
### TCP/IP 参考模型

TCP/IP 参考模型由四层组成，从上到下依次为应用层（Application Layer）、传输层（Transport Layer）、网络层（Internet Layer）、网络接口层（Host-to-Network Layer）

- 链路层（Link Layer）：描述了为满足无连接的互联网络层需求，链路必须具备的功能
- 互联网层（Internet Layer）：允许主机将数据包注入网络，让这些数据包独立的传输至目的地，并定义了数据包格式和协议（IPv4 协议和 IPv6 协议）
- 传输层（Transport Layer）：允许源主机与目标主机上的对等实体，进行端到端的数据传输：TCP，UDP
- 应用层（Application Layer）：传输层之上的所有高层协议：DNS、HTTP、FTP、SMTP...

TCP/IP 参考模型摒弃了电话系统中“笨终端 & 聪明网络”的设计思路，采取了端对端原则（采用聪明终端&简单网络，由端系统负责丢失恢复等，简单的网络大大提升了可扩展性），实现了建立在简单的、不可靠部件上的可靠系统

!!! note "IP 分组交换的特点"

	- 可在各种底层物理网络上运行
	- 可支持各类上层应用
	- 每个 IP 分组携带各自的目的地址，网络核心功能简单（通过路由表转发分组），适应爆炸性增长
















# Crypto-4｜ez_square

## Tag

数学变形，RSA
***
## Writeup

由题意泄露出一个 $\text{hint}=(p+q)^2\mod n=p^2 + q^2\mod n$，可以得到 $(p+q)^2=\text{hint} + k*n$，且感性理解 $k$ 也不会很大，直接枚举 $k$ 即可，Payload 如下：

```python
from Crypto.Util.number import *
import gmpy2

n = 83917281059209836833837824007690691544699901753577294450739161840987816051781770716778159151802639720854808886223999296102766845876403271538287419091422744267873129896312388567406645946985868002735024896571899580581985438021613509956651683237014111116217116870686535030557076307205101926450610365611263289149
c = 69694813399964784535448926320621517155870332267827466101049186858004350675634768405333171732816667487889978017750378262941788713673371418944090831542155613846263236805141090585331932145339718055875857157018510852176248031272419248573911998354239587587157830782446559008393076144761176799690034691298870022190
hint = 5491796378615699391870545352353909903258578093592392113819670099563278086635523482350754035015775218028095468852040957207028066409846581454987397954900268152836625448524886929236711403732984563866312512753483333102094024510204387673875968726154625598491190530093961973354413317757182213887911644502704780304
e = 65537

count = 1
while True:
    trial = hint + count * n
    if gmpy2.is_square(trial):
        break
    count += 1

p = (gmpy2.iroot(trial, 2)[0] + gmpy2.iroot(trial - 4 * n, 2)[0]) // 2
q = (gmpy2.iroot(trial, 2)[0] - gmpy2.iroot(trial - 4 * n, 2)[0]) // 2

phi = (p - 1) * (q - 1)
d = pow(e, -1, phi)
m = pow(c, d, n)
print(f"[*] Flag: {long_to_bytes(m).decode()}")
```

得到 flag：`moectf{Ma7hm4t1c5_is_@_k1nd_0f_a2t}`
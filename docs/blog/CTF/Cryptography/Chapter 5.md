---
hide:
  #- navigation # 显示右
  #- toc #显示左
  - footer
  - feedback
comments: true
--- 

# Chapter 05 : DES 算法和 AES 算法

## DES 算法

DES（Data Encryption Standard）是一种对称密钥加密算法，采用大端序存储数据，明文和密钥均为 64 位
***
### 加密过程

DES 算法的加密过程包括以下几个步骤：

1. 首先对 64 位的明文进行初始置换，得到一个 64 位的中间结果
2. 中间结果的 8 字节会被分成左边 4 字节和右边 4 字节，在 DES 框架代码中分别表示为 $L[0],R[0]$
3. 第 0 轮循环先对 $L[0]$ 加密，生成 $L[1]$；$R[0]$ 不作改变直接赋值给 $R[1]$
4. 第 1 轮循环先对 $R[1]$ 加密，生成 $R[2]$；$L[1]$ 不作改变直接赋值给 $L[2]$
5. 如此反复得到最后的 $L[16],R[16]$，最后进行初始置换的逆置换得到密文

![](../../../assets/Pasted%20image%2020250412150205.png)

其中，初始置换的转换表如下：

![](../../../assets/Pasted%20image%2020250412161823.png)

对于其中的加密过程，即图中的函数 $f$，可以分为密钥处理、扩展子块、 SBOX 替换三个步骤：
***
#### 密钥处理

先对密钥进行处理：

![](../../../assets/Pasted%20image%2020250412150929.png)

压缩置换 1 是将 64 位的密钥压缩成 56 位，本质是原密钥的拆分重组，转换表如下：

![](../../../assets/Pasted%20image%2020250412161209.png)

每个子密钥的循环左移次数如下：

![](../../../assets/Pasted%20image%2020250412161345.png)

压缩置换 2 的转换表如下：

![](../../../assets/Pasted%20image%2020250412161424.png)
***
#### 扩展子块

因为我们生成的密钥为 48 位，因此我们还需要将加密的 32 位扩展成 48 位方便异或操作，扩展表如下：

![](../../../assets/Pasted%20image%2020250412161839.png)

***
#### SBOX 替换

将压缩后的密钥和扩展后的子块异或之后，我们得到了一个 48 位的中间结果。接下来我们需要将这个中间结果分成 8 个 6 位的子块，然后对每个子块进行 SBOX 替换，得到 32 位的输出。SBOX 对应也有 8 个，第一个的转换表如下：

![](../../../assets/Pasted%20image%2020250412163348.png)

对于输入的 6 位中间结果，我们取第一位和最后一位拼成一个两位二进制数字表示行号，中间四位二进制数字表示列号，对应的 SBOX 中的结果即为替换后的结果，所有 8 个 SBOX 生成替换结果拼起来即为替换结果
***
### 缺点

DES 有如下缺点：

- 密钥长度太短
- 利用差分分析可以攻击 DES 算法
- SBOX 没有公开，怀疑有后门
***

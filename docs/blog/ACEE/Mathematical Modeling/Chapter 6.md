---
hide:
  #- navigation # 显示右
  #- toc #显示左
  - footer
  - feedback
comments: true
--- 

# Chapter 06 : 随机模型

## 随机性

- 必然性与偶然性：揭示客观事物发生、发展和灭亡趋势的一对范畴。
	- 必然性（Necessity）：客观事物联系和发展中一定要发生的、确定不移的趋势
	- 偶然性（Contingency）：客观事物联系发展中并非确定发生的，可以这样出现也可以那样出现的不确定趋势
- 随机性（Randomness）：偶然性的一种形式
	- 可重复性：事件可以在基本相同的条件下重复进行。只有单一的偶然过程而无法判定它的可重复性则不称为随机事件
	- 多样性：在基本相同条件下某事件可能以多种方式表现出来，事先不能确定它以何种特定方式发生。只有唯一可能性的过程不是随机事件
	- 概率性：事先可以预见该事件以各种方式出现的所有可能性，预见它以某种特定方式出现的概率。在重复发生时没有确定概率的现象不是同一过程的随机事件
***
## 疾病检测

- 记 $A$ 为患病，$B$ 为检测结果为阳性，疾病检测方法的性能指标为：
	- 灵敏度（Sensitivity）$p=P(B|A)$：患病者被检测为阳性（Positive）的概率
	- 特异度（Specificity）$q=P(\overline{B}|\overline{A})$：未患病者被检测为阴性（Negative）的概率
- 设疾病的发病率为 $r$ ，则被检测出阳性的情况下患病的概率为

$$
P(A|B)=\frac{P(B|A)P(A)}{P(B|A)P(A)+P(B|\overline{A})P(\overline{A})}=\frac{pr}{pr+(1-q)(1-r)}
$$
***
### 概率群式

概率群式：假定 $n$ 个人相互独立地以概率 $p$ 患病，如何找出全部的病人，使平均检测次数尽可能少？

> 对于选择群式方案，我们要考虑平均检测次数、检测阶段数、每人最大检测次数、每组最多样本数、方案的可操作性、检测的灵敏度与特异度等多个因素
***
#### 两阶段群式

- 将 $n$ 人的样本混合后检测。若结果为阴性，说明这 $n$ 人均未感染。若结果为阳性，说明这 $n$ 人中至少有一人已感染。此时逐个检测每个人样本

对于这样的检测方案，检测次数如下：

- 混合样本阴性概率为 $(1−p)^n$ ，总检测次数为 1
- 混合样本阳性概率为 $1−(1−p)^n$，总检测次数为 $n+1$
- 检测次数的数学期望为 $1⋅(1−p)^n+(n+1)⋅(1−(1−p)^n)$

所以平均检测次数的数学期望为 $\frac{1⋅(1−p)^n+(n+1)⋅(1−(1−p)^n)}{n}$
***
#### 矩阵检测方案

> 矩阵检测方案是概率群式的改进方案

!!! note "矩阵检测方案"

	=== "自适应思路"
	
		将 $m\times n$ 个人按矩阵排好，先检测每行样本，若结果为阴性，说明这 $n$ 人均未感染。若结果为阳性，说明这 $n$ 人中至少有一人已感染。此时逐个检测每列样本。
		
		这样每行就相当于两阶段群式中的混合样本，每列就相当于两阶段群式中的每个人样本，检测次数数学期望为 $m\times(1⋅(1−p)^n+(n+1)⋅(1−(1−p)^n))$，平均检测次数数学期望仍然为 $\frac{1⋅(1−p)^n+(n+1)⋅(1−(1−p)^n)}{n}$
	
	=== "非自适应思路"
	
		将 $m\times n$ 个人按矩阵排好，对每行每列分别进行检测。通过检测结果确定感染者的位置。
		
		这样需要的检测次数恒为 $m+n$
***
#### 三阶段检测方案

- 第一阶段：有 $n$ 个人，进行总体的混合检测，若结果为阴性，说明这 $n$ 人均未感染。若结果为阳性，说明这 $n$ 人中至少有一人已感染。进入第二阶段
- 第二阶段：将这 $n$ 人分成 $A,B$ 两组，每组 $\frac{n}{2}$ 人，先对 $A$ 组进行检测，若结果为阴性，说明这 $\frac{n}{2}$ 人均未感染，且确定感染者在 $B$ 组。若结果为阳性，说明这 $\frac{n}{2}$ 人中至少有一人已感染，但仍需确定 $B$ 组是否有感染者，此时对 $B$ 组进行总体的混合检测
- 第三阶段：对有感染者的组进行逐个检测，确定感染者的位置

![](../../../assets/Pasted%20image%2020241220171251.png)

!!! note "检测次数"

	- 对于第一阶段，结果为阴性的概率为 $(1-p)^n$，总检测次数为 1
	- 对于第二阶段：
		- $A$ 组结果为阴性的概率为 $(1-p)^{\frac{n}{2}}$，此时 $B$ 组必然为阳性，这发生的概率为 $1-(1-p)^{\frac{n}{2}}$，总检测次数为 $1+1+\frac{n}{2}=2+\frac{n}{2}$
		- $A$ 组结果为阳性的概率为 $1−(1−p)^{\frac{n}{2}}$，$B$ 组结果为阴性的概率为 $(1−p)^{\frac{n}{2}}$，总检测次数为 $1+1+\frac{n}{2}+1=3+\frac{n}{2}$
		- $A$ 组结果为阳性的概率为 $1−(1−p)^{\frac{n}{2}}$，$B$ 组结果为阳性的概率为 $1−(1−p)^{\frac{n}{2}}$，总检测次数为 $1+1+\frac{n}{2}+1+\frac{n}{2}=3+n$
	
	所以总检测次数的数学期望为：
	
	$$
	\begin{aligned}
	&(1-p)^n·1+(1-p)^{\frac{n}{2}}(1-(1-p)^{\frac{n}{2}})·(2+\frac{n}{2})\\
	+&(1-(1-p)^{\frac{n}{2}})(1-p)^{\frac{n}{2}}·(3+\frac{n}{2})+(1-(1-p)^{\frac{n}{2}})^2·(3+n)\\
	=&n+3-(n+1)(1-p)^{\frac{n}{2}}-(1-p)^n
	\end{aligned}
	$$
	
	平均检测次数的数学期望为 $1+\frac{3}{n}-(1+\frac{1}{n})(1-p)^{\frac{n}{2}}-\frac{1}{n}(1-p)^n$
***
